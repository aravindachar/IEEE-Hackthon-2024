<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,
    initial-scale=1.0">
    <title>Dashboard Login</title>
    <link rel="stylesheet" href="css\style2.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>

<body>   
    <div class="wrapper">
        <div action="">
            <h1>Guide Login</h1>
            <div class="typ-typ">
            <a href=""><button>Guide</button></a>
            <a href=""><button>Tourist</button></a>
          </div>
            <div class="input-box">
                <input type="email" placeholder="Guide Number" id="email" required>
                <i class='bx bx-envelope'></i>
            </div>


            <div class="input-box">
                <input type="password" placeholder="Password" id="password" required>
                <i class = 'bx bxs-lock-alt'></i>
            </div>

            
            
            <button type="submit" class="btn" id="Login" name="login-submit" value="Login">Login</button>

            <br><br>

            <a href="register.html", class="custom-link">New User? Register</a>
            
        </div>
    </div>

</body>

<script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
    import { getDatabase, ref, update } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-database.js";
    import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";

    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyA3hH7rtHyiKa5mTTpOp3zhhfybgVlACqg",
      authDomain: "shastra-travels.firebaseapp.com",
      projectId: "shastra-travels",
      storageBucket: "shastra-travels.appspot.com",
      messagingSenderId: "418461493645",
      appId: "1:418461493645:web:a71d75c1b7ced156a135c4"
    };
    
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);
    const auth = getAuth();


    
    
    
    
    Login.addEventListener('click', (e) => {

        var email = document.getElementById('email').value;
        var password = document.getElementById('password').value;

    signInWithEmailAndPassword(auth, email, password)
  .then((userCredential) => {
    const user = userCredential.user;
    const dt = new Date();
    update(ref(database, 'users/' + user.uid),{
        last_login: dt,
    })

    setTimeout(function() {
  window.location.href = "test1.html";
}, 1);


  })
  .catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;
    alert(errorMessage);
  });

});
  </script>
</html>